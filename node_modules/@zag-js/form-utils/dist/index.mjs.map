{"version":3,"sources":["../src/input-event.ts","../src/form.ts"],"sourcesContent":["type DescriptorOptions = {\n  type: \"HTMLInputElement\" | \"HTMLTextAreaElement\" | \"HTMLSelectElement\"\n  property?: \"value\" | \"checked\"\n}\n\nconst getWindow = (el: HTMLElement) => el.ownerDocument.defaultView || window\n\nfunction getDescriptor(el: HTMLElement, options: DescriptorOptions) {\n  const { type, property = \"value\" } = options\n  const proto = getWindow(el)[type].prototype\n  return Object.getOwnPropertyDescriptor(proto, property) ?? {}\n}\n\nexport function setElementValue(el: HTMLElement, value: string, option: DescriptorOptions) {\n  const descriptor = getDescriptor(el, option)\n  descriptor.set?.call(el, value)\n}\n\nexport type InputEventOptions = {\n  value: string | number\n  bubbles?: boolean\n}\n\nexport function dispatchInputValueEvent(el: HTMLElement | null, options: InputEventOptions) {\n  if (!el) return\n\n  const win = getWindow(el)\n  if (!(el instanceof win.HTMLInputElement)) return\n\n  const { value, bubbles = true } = options\n\n  // set property value\n  const descriptor = getDescriptor(el, {\n    type: \"HTMLInputElement\",\n    property: \"value\",\n  })\n\n  descriptor.set?.call(el, value)\n\n  // dispatch input event\n  const event = new win.Event(\"input\", { bubbles })\n  el.dispatchEvent(event)\n}\n\nexport type CheckedEventOptions = {\n  checked: boolean\n  bubbles?: boolean\n}\n\nexport function dispatchInputCheckedEvent(el: HTMLElement | null, options: CheckedEventOptions) {\n  if (!el) return\n\n  const win = getWindow(el)\n  if (!(el instanceof win.HTMLInputElement)) return\n\n  const { checked, bubbles = true } = options\n\n  // set property value\n  const descriptor = getDescriptor(el, {\n    type: \"HTMLInputElement\",\n    property: \"checked\",\n  })\n\n  descriptor.set?.call(el, checked)\n\n  // dispatch click event\n  const event = new win.Event(\"click\", { bubbles })\n  el.dispatchEvent(event)\n}\n","import { observeAttributes } from \"@zag-js/mutation-observer\"\n\nexport function getClosestForm(el: HTMLElement) {\n  if (isFormElement(el)) return el.form\n  else return el.closest(\"form\")\n}\n\nfunction isFormElement(el: HTMLElement): el is HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement {\n  return el.matches(\"textarea, input, select, button\")\n}\n\nfunction trackFormReset(el: HTMLElement | null | undefined, callback: () => void) {\n  if (!el) return\n  const form = getClosestForm(el)\n  form?.addEventListener(\"reset\", callback, { passive: true })\n  return () => {\n    form?.removeEventListener(\"reset\", callback)\n  }\n}\n\nfunction trackFieldsetDisabled(el: HTMLElement | null | undefined, callback: (disabled: boolean) => void) {\n  const fieldset = el?.closest(\"fieldset\")\n  if (!fieldset) return\n  callback(fieldset.disabled)\n  return observeAttributes(fieldset, [\"disabled\"], () => callback(fieldset.disabled))\n}\n\nexport function isNativeDisabled(el: HTMLElement) {\n  return el.matches(\":disabled\")\n}\n\nexport type FormControlOptions = {\n  onFieldsetDisabled: () => void\n  onFormReset: () => void\n}\n\nexport function trackFormControl(el: HTMLElement | null, options: FormControlOptions) {\n  if (!el) return\n\n  const { onFieldsetDisabled, onFormReset } = options\n\n  const cleanups = [\n    trackFormReset(el, onFormReset),\n    trackFieldsetDisabled(el, (disabled) => {\n      if (disabled) onFieldsetDisabled()\n    }),\n  ]\n\n  return () => {\n    cleanups.forEach((cleanup) => cleanup?.())\n  }\n}\n"],"mappings":";AAKA,IAAM,YAAY,CAAC,OAAoB,GAAG,cAAc,eAAe;AAEvE,SAAS,cAAc,IAAiB,SAA4B;AAClE,QAAM,EAAE,MAAM,WAAW,QAAQ,IAAI;AACrC,QAAM,QAAQ,UAAU,EAAE,EAAE,IAAI,EAAE;AAClC,SAAO,OAAO,yBAAyB,OAAO,QAAQ,KAAK,CAAC;AAC9D;AAEO,SAAS,gBAAgB,IAAiB,OAAe,QAA2B;AACzF,QAAM,aAAa,cAAc,IAAI,MAAM;AAC3C,aAAW,KAAK,KAAK,IAAI,KAAK;AAChC;AAOO,SAAS,wBAAwB,IAAwB,SAA4B;AAC1F,MAAI,CAAC;AAAI;AAET,QAAM,MAAM,UAAU,EAAE;AACxB,MAAI,EAAE,cAAc,IAAI;AAAmB;AAE3C,QAAM,EAAE,OAAO,UAAU,KAAK,IAAI;AAGlC,QAAM,aAAa,cAAc,IAAI;AAAA,IACnC,MAAM;AAAA,IACN,UAAU;AAAA,EACZ,CAAC;AAED,aAAW,KAAK,KAAK,IAAI,KAAK;AAG9B,QAAM,QAAQ,IAAI,IAAI,MAAM,SAAS,EAAE,QAAQ,CAAC;AAChD,KAAG,cAAc,KAAK;AACxB;AAOO,SAAS,0BAA0B,IAAwB,SAA8B;AAC9F,MAAI,CAAC;AAAI;AAET,QAAM,MAAM,UAAU,EAAE;AACxB,MAAI,EAAE,cAAc,IAAI;AAAmB;AAE3C,QAAM,EAAE,SAAS,UAAU,KAAK,IAAI;AAGpC,QAAM,aAAa,cAAc,IAAI;AAAA,IACnC,MAAM;AAAA,IACN,UAAU;AAAA,EACZ,CAAC;AAED,aAAW,KAAK,KAAK,IAAI,OAAO;AAGhC,QAAM,QAAQ,IAAI,IAAI,MAAM,SAAS,EAAE,QAAQ,CAAC;AAChD,KAAG,cAAc,KAAK;AACxB;;;ACpEA,SAAS,yBAAyB;AAE3B,SAAS,eAAe,IAAiB;AAC9C,MAAI,cAAc,EAAE;AAAG,WAAO,GAAG;AAAA;AAC5B,WAAO,GAAG,QAAQ,MAAM;AAC/B;AAEA,SAAS,cAAc,IAAmF;AACxG,SAAO,GAAG,QAAQ,iCAAiC;AACrD;AAEA,SAAS,eAAe,IAAoC,UAAsB;AAChF,MAAI,CAAC;AAAI;AACT,QAAM,OAAO,eAAe,EAAE;AAC9B,QAAM,iBAAiB,SAAS,UAAU,EAAE,SAAS,KAAK,CAAC;AAC3D,SAAO,MAAM;AACX,UAAM,oBAAoB,SAAS,QAAQ;AAAA,EAC7C;AACF;AAEA,SAAS,sBAAsB,IAAoC,UAAuC;AACxG,QAAM,WAAW,IAAI,QAAQ,UAAU;AACvC,MAAI,CAAC;AAAU;AACf,WAAS,SAAS,QAAQ;AAC1B,SAAO,kBAAkB,UAAU,CAAC,UAAU,GAAG,MAAM,SAAS,SAAS,QAAQ,CAAC;AACpF;AAEO,SAAS,iBAAiB,IAAiB;AAChD,SAAO,GAAG,QAAQ,WAAW;AAC/B;AAOO,SAAS,iBAAiB,IAAwB,SAA6B;AACpF,MAAI,CAAC;AAAI;AAET,QAAM,EAAE,oBAAoB,YAAY,IAAI;AAE5C,QAAM,WAAW;AAAA,IACf,eAAe,IAAI,WAAW;AAAA,IAC9B,sBAAsB,IAAI,CAAC,aAAa;AACtC,UAAI;AAAU,2BAAmB;AAAA,IACnC,CAAC;AAAA,EACH;AAEA,SAAO,MAAM;AACX,aAAS,QAAQ,CAAC,YAAY,UAAU,CAAC;AAAA,EAC3C;AACF;","names":[]}